<!DOCTYPE html>
<html lang="en"><head>
<script src="Lecture17FactorAnalysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture17FactorAnalysis_files/libs/quarto-html/tabby.min.js"></script>
<script src="Lecture17FactorAnalysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture17FactorAnalysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Lecture17FactorAnalysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture17FactorAnalysis_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Lecture17FactorAnalysis_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Lecture17FactorAnalysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.555">

  <meta name="author" content="Zhaoxia Yu | Professor, Department of Statistics">
  <meta name="dcterms.date" content="2025-05-27">
  <title>Multivariate Analysis Lecture 17: Factor Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Lecture17FactorAnalysis_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Lecture17FactorAnalysis_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Lecture17FactorAnalysis_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Lecture17FactorAnalysis_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Lecture17FactorAnalysis_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Lecture17FactorAnalysis_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Lecture17FactorAnalysis_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Multivariate Analysis Lecture 17: Factor Analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Zhaoxia Yu | Professor, Department of Statistics 
</div>
</div>
</div>

  <p class="date">2025-05-27</p>
</section>
<section id="required-packages" class="slide level2">
<h2>Required packages</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-3"><a href=""></a><span class="fu">library</span>(tidyr) <span class="co">#the pipe (%&gt;%) tool is extremely useful</span></span>
<span id="cb1-4"><a href=""></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-5"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href=""></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href=""></a></span>
<span id="cb1-8"><a href=""></a><span class="fu">library</span>(corrplot)<span class="co">#for visualizing the corr matrix of the iris data</span></span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="fu">library</span>(png)</span>
<span id="cb1-11"><a href=""></a><span class="fu">library</span>(grid)</span>
<span id="cb1-12"><a href=""></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-13"><a href=""></a></span>
<span id="cb1-14"><a href=""></a><span class="co">#install.packages("psych")</span></span>
<span id="cb1-15"><a href=""></a><span class="co">#install.packages("semPlot")</span></span>
<span id="cb1-16"><a href=""></a><span class="co">#install.packages("lavaan")</span></span>
<span id="cb1-17"><a href=""></a><span class="co">#install.packages("lavaanPlot")</span></span>
<span id="cb1-18"><a href=""></a><span class="fu">library</span>(psych)</span>
<span id="cb1-19"><a href=""></a><span class="fu">library</span>(semPlot)  </span>
<span id="cb1-20"><a href=""></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-21"><a href=""></a><span class="fu">library</span>(lavaanPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="outline" class="title-slide slide level1 center">
<h1>Outline</h1>
<ul>
<li>Review of PCA</li>
</ul>
</section>

<section>
<section id="motivating-example" class="title-slide slide level1 center">
<h1>Motivating Example</h1>

</section>
<section id="a-motivating-example-exam-scores" class="slide level2">
<h2>A Motivating Example: Exam Scores</h2>
<ul>
<li>Simulated data</li>
<li>60 students</li>
<li>six subjects: Latin, English, History, Arithmetic, Algebra, Geometry </li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb2-2"><a href=""></a>mu<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href=""></a>mu1<span class="ot">=</span>mu<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>)</span>
<span id="cb2-4"><a href=""></a>mu2<span class="ot">=</span>mu<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>)</span>
<span id="cb2-5"><a href=""></a>exam<span class="ot">=</span><span class="fu">cbind</span>(mu1<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>), mu1<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>), mu1<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>), </span>
<span id="cb2-6"><a href=""></a>          mu2<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>), mu2<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>), mu2<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">sd=</span><span class="fl">0.5</span>))</span>
<span id="cb2-7"><a href=""></a><span class="fu">colnames</span>(exam)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Latin"</span>,<span class="st">"English"</span>,<span class="st">"History"</span>,</span>
<span id="cb2-8"><a href=""></a>                 <span class="st">"Arithmetic"</span>,<span class="st">"Algebra"</span>,<span class="st">"Geometry"</span>)</span>
<span id="cb2-9"><a href=""></a>exam<span class="ot">=</span><span class="fu">data.frame</span>(exam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pairwise-correlation" class="slide level2">
<h2>Pairwise Correlation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(exam), <span class="at">method=</span><span class="st">"number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section>
<section id="pca-visualize-eigenvalues" class="slide level2">
<h2>PCA: Visualize Eigenvalues</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>obj<span class="ot">=</span><span class="fu">princomp</span>(exam, <span class="at">cor=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href=""></a><span class="fu">cumsum</span>(obj<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>(obj<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Comp.1    Comp.2    Comp.3    Comp.4    Comp.5    Comp.6 
0.6986579 0.9361760 0.9583366 0.9742750 0.9873617 1.0000000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">plot</span>(obj, <span class="at">type=</span><span class="st">"lines"</span>, <span class="at">main=</span><span class="st">"Scree Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:90.0%"></section>
<section id="pca-loadings" class="slide level2">
<h2>PCA Loadings</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>obj<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
           Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
Latin       0.394  0.456  0.176  0.149  0.756  0.107
English     0.426  0.360 -0.127 -0.187 -0.465  0.650
History     0.417  0.393 -0.139        -0.323 -0.740
Arithmetic  0.414 -0.368  0.806        -0.193       
Algebra     0.396 -0.437 -0.456  0.659              
Geometry    0.402 -0.427 -0.275 -0.708  0.265       

               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
SS loadings     1.000  1.000  1.000  1.000  1.000  1.000
Proportion Var  0.167  0.167  0.167  0.167  0.167  0.167
Cumulative Var  0.167  0.333  0.500  0.667  0.833  1.000</code></pre>
</div>
</div>
<ul>
<li>1st PC is about average</li>
<li>2nd PC is about difference between Latin/English/History and Arithmetic/Algebra/Geometry </li>
</ul>
</section>
<section id="pca" class="slide level2">
<h2>PCA</h2>
<ul>
<li><p>1st PC = 0.39Latin+0.43English+0.42History +0.41Arithmetic+0.40Algebra+0.40Geometry</p></li>
<li><p>2nd PC = 0.46Latin+0.36English+0.39History -0.37Arithmetic-0.44Algebra-0.43Geometry</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>obj<span class="sc">$</span>scores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="co">#first two PCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Comp.1       Comp.2
 [1,] -0.12510081  0.387885389
 [2,] -0.24313883  0.565843287
 [3,]  0.61706648 -1.169012826
 [4,]  1.57192571 -1.061544977
 [5,] -1.01259642  0.511535779
 [6,]  0.08159618  0.709633832
 [7,] -3.97028171  1.616681077
 [8,]  1.40252349 -1.718247894
 [9,] -0.87166984 -0.676249351
[10,] -2.83899249  1.873213808
[11,]  2.72771614 -0.850526753
[12,] -1.70338268 -1.375732667
[13,]  0.45223712  1.335051512
[14,] -0.73935793 -0.391321467
[15,]  0.36383804 -1.679191292
[16,] -0.40033457 -0.951024825
[17,]  4.07653952 -1.202123539
[18,]  0.61591640  0.133077527
[19,] -0.12488695  0.259977199
[20,]  3.32163279  2.091207138
[21,]  2.00387753  3.054062570
[22,] -1.33374043 -0.320546882
[23,]  5.52664746  0.816383883
[24,] -0.33635132 -1.217102103
[25,] -0.10498766 -1.814458635
[26,] -4.21673559 -0.146734355
[27,]  1.65883546  1.052902505
[28,]  2.16635789  1.786264476
[29,]  2.73200731 -1.478791682
[30,] -1.27463938 -0.621599441
[31,] -2.37991077 -1.616443270
[32,]  1.37425859  0.969212378
[33,] -2.47024496  2.191557493
[34,] -0.02205375  0.198973539
[35,]  1.27620254  1.394858358
[36,] -1.69777512 -1.082925687
[37,]  1.21645111  1.935638299
[38,]  2.17466798 -0.001283984
[39,] -2.26900283  1.182184153
[40,] -4.47651168  0.610396065
[41,] -1.16212454 -1.013488801
[42,] -0.46563689 -0.170207403
[43,] -0.25281534 -0.155695673
[44,] -0.64299833 -0.617060300
[45,]  1.60383026 -1.065000051
[46,] -0.49803511 -1.390479937
[47,] -0.42374873 -0.582368919
[48,]  2.95636926  1.190798983
[49,] -1.27521832  0.505207025
[50,] -0.14644013 -0.618323482
[51,]  0.29360813 -1.258124936
[52,] -1.53084891  0.644636778
[53,] -1.16723274 -1.853200992
[54,]  2.73613797  0.871310350
[55,] -1.90680059 -0.110926424
[56,]  3.14836985 -0.234451019
[57,] -3.98034871  1.828724734
[58,] -1.63857531  0.287901854
[59,]  0.03921813 -1.629983051
[60,]  1.56468801  0.069052627</code></pre>
</div>
</div>
</section>
<section id="visualize-pcs-biplot" class="slide level2">
<h2>Visualize PCs (biplot)</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">biplot</span>(obj, <span class="at">main=</span><span class="st">"Biplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section></section>
<section>
<section id="introduction-to-factor-analysis" class="title-slide slide level1 center">
<h1>Introduction to Factor Analysis</h1>
<ul>
<li>Factor analysis (FA) is a statistical model used to identify underlying relationships between variables.</li>
<li>It tries to understand/identify what (latent factors) leads to the observed correlations among a set of variables.</li>
</ul>
</section>
<section id="pca-vs-fa" class="slide level2">
<h2>PCA vs FA</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/PCA_FA.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="img/PCA_FA.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"><p>https://livebook.manning.com/book/r-in-action-second-edition/chapter-14/6 </p>
</section>
<section id="pca-vs-fa-1" class="slide level2">
<h2>PCA vs FA</h2>
<ul>
<li>Both reduce dimensionality</li>
<li>Different goals:
<ul>
<li>PCA: aims to reduce the number of variables while preserving as much variance as possible</li>
<li>FA: aims to identify latent factors that explain the correlations among observed variables</li>
</ul></li>
<li>PCA: finds PCs (eg, PC1, PC2). Focuses on total variance.</li>
<li>FA: find latent factors (eg, F1, F2). Focuses on correlations.</li>
</ul>
</section></section>
<section>
<section id="fa-model" class="title-slide slide level1 center">
<h1>FA Model</h1>

</section>
<section id="factor-model" class="slide level2">
<h2>Factor Model</h2>
<ul>
<li>Consider a random vector <span class="math inline">\(\mathbf X \in \mathbb R^p\)</span></li>
<li>Let <span class="math inline">\(\boldsymbol \mu \in \mathbb R^p\)</span> denote the population mean</li>
<li>Let <span class="math inline">\(F\in \mathbb R^m\)</span> denote <span class="math inline">\(m\)</span> factors</li>
</ul>
<p><span class="math display">\[\mathbf{X} = \left(\begin{array}{c}X_1\\X_2\\\vdots\\X_p\end{array}\right), \boldsymbol{\mu} = \left(\begin{array}{c}\mu_1\\\mu_2\\\vdots\\\mu_p\end{array}\right), \mathbf{F} = \left(\begin{array}{c}f_1\\f_2\\\vdots\\f_m\end{array}\right)\]</span></p>
</section>
<section id="factor-model-1" class="slide level2">
<h2>Factor model</h2>
<ul>
<li><span class="math inline">\(X_j\)</span>, which is observable, is assumed to be a linear function of the unobservable <span class="math inline">\(f_1, \cdots, f_m\)</span> plus specific errors. <span class="math display">\[\begin{aligned} X_1 &amp; = \mu_1 + l_{11}f_1 + l_{12}f_2 + \dots + l_{1m}f_m + \epsilon_1\\ X_2 &amp; = \mu_2 + l_{21}f_1 + l_{22}f_2 + \dots + l_{2m}f_m + \epsilon_2 \\ &amp; \vdots \\ X_p &amp; = \mu_p + l_{p1}f_1 + l_{p2}f_2 + \dots + l_{pm}f_m + \epsilon_p \end{aligned}\]</span> where <span class="math inline">\(\epsilon_j\)</span> is called the specific factor for feature <span class="math inline">\(j\)</span>.</li>
<li>The means <span class="math inline">\(\mu_1, \cdots, \mu_p\)</span> are parameters</li>
<li>The coefficients in the factor loading matrix are also parameters</li>
</ul>
</section>
<section id="factor-model-2" class="slide level2">
<h2>Factor model</h2>
<ul>
<li>Let <span class="math inline">\(\mathbf L\)</span> denote the <span class="math inline">\(p\times m\)</span> matrix of factor loadings <span class="math display">\[\mathbf{L} = \left(\begin{array}{cccc}l_{11}&amp; l_{12}&amp; \dots &amp; l_{1m}\\l_{21} &amp; l_{22} &amp; \dots &amp; l_{2m}\\ \vdots &amp; \vdots &amp; &amp; \vdots \\l_{p1} &amp; l_{p2} &amp; \dots &amp; l_{pm}\end{array}\right) \]</span></li>
<li>A compact expression of the factor model is <span class="math display">\[\mathbf X_{p\times 1} = \boldsymbol \mu_{p\times 1} + \mathbf L_{p\times m} \mathbf F_{m\times 1} + \boldsymbol \epsilon_{p\times 1}\]</span></li>
</ul>
</section>
<section id="example-loading" class="slide level2">
<h2>Example: Loading</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>obj<span class="ot">=</span><span class="fu">factanal</span>(exam, <span class="at">factors=</span><span class="dv">2</span>, <span class="at">scores=</span><span class="st">"regression"</span>)</span>
<span id="cb13-2"><a href=""></a>obj<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
           Factor1 Factor2
Latin      0.937   0.195  
English    0.905   0.321  
History    0.920   0.280  
Arithmetic 0.290   0.878  
Algebra    0.207   0.923  
Geometry   0.220   0.931  

               Factor1 Factor2
SS loadings      2.718   2.710
Proportion Var   0.453   0.452
Cumulative Var   0.453   0.905</code></pre>
</div>
</div>
<ul>
<li>How to interpret the loadings and the two factors?</li>
</ul>
</section>
<section id="example-scores" class="slide level2">
<h2>Example: Scores</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>obj.heatmap<span class="ot">=</span><span class="fu">heatmap</span>(obj<span class="sc">$</span>scores, <span class="at">main=</span><span class="st">"Factor Scores"</span>, <span class="at">col=</span><span class="fu">heat.colors</span>(<span class="dv">256</span>, <span class="at">rev=</span><span class="cn">TRUE</span>), <span class="at">scale=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><ul>
<li>How to interpret the scores</li>
</ul>
</section>
<section id="example-original-scores-sorted" class="slide level2">
<h2>Example: Original Scores (sorted)</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>tmp<span class="ot">=</span><span class="fu">as.matrix</span>(exam)[obj.heatmap<span class="sc">$</span>rowInd,]</span>
<span id="cb16-2"><a href=""></a><span class="fu">row.names</span>(tmp)<span class="ot">=</span>obj.heatmap<span class="sc">$</span>rowInd</span>
<span id="cb16-3"><a href=""></a><span class="fu">heatmap</span>(tmp, <span class="at">main=</span><span class="st">"Exam Scores"</span>,  <span class="at">col=</span><span class="fu">heat.colors</span>(<span class="dv">256</span>, <span class="at">rev=</span><span class="cn">TRUE</span>), <span class="at">Rowv=</span><span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="mathematical-details-assumptions" class="slide level2">
<h2>Mathematical Details: Assumptions</h2>
<ul>
<li><p><span class="math inline">\(\mathbf F\)</span> and <span class="math inline">\(\boldsymbol \epsilon\)</span> are uncorrelated</p></li>
<li><p>The <span class="math inline">\(m\)</span> common factors are uncorrelated <span class="math display">\[\mathbb E(\mathbf F)=0, Cov(\mathbf F)=\mathbf I_m\]</span></p></li>
<li><p>The specific factors are uncorrelated <span class="math display">\[\mathbb E(\boldsymbol\epsilon)=0, Cov(\boldsymbol\epsilon)=\Psi\]</span> where <span class="math inline">\(\Psi\)</span> is a diagonal matrix with non-negative values, i.e.,</p></li>
</ul>
<p><span class="math display">\[\boldsymbol{\Psi} = \left(\begin{array}{cccc}\psi_1 &amp; 0 &amp; \dots &amp; 0 \\ 0 &amp; \psi_2 &amp; \dots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\ 0 &amp; 0 &amp; \dots &amp; \psi_p \end{array}\right)\]</span></p>
</section>
<section id="the-covariance" class="slide level2">
<h2>The Covariance</h2>
<ul>
<li>By the factor model and its assumptions, we have</li>
</ul>
<p><span class="math display">\[\begin{aligned}
\Sigma&amp;=cov(\mathbf X)\\
&amp;= cov(\mathbf L\mathbf F + \boldsymbol \epsilon)\\
&amp;=\mathbf L Cov(\mathbf F) \mathbf L^T + \Psi\\
&amp;=\mathbf L  \mathbf L^T + \Psi
\end{aligned}
\]</span> The last step is due to our assumption that <span class="math inline">\(cov(\mathbf F)=\mathbf I\)</span></p>
</section>
<section id="the-covariance-1" class="slide level2">
<h2>The Covariance</h2>
<ul>
<li>For <span class="math inline">\(i\not=j\)</span>, the covariance between <span class="math inline">\(X_i\)</span> (feature <span class="math inline">\(i\)</span>) and <span class="math inline">\(X_j\)</span> (feature <span class="math inline">\(j\)</span>) is <span class="math display">\[\sigma_{ij}=cov(X_i, X_j)=\sum_{k=1}^m l_{ik}l_{jk}\]</span></li>
<li>The variance of <span class="math inline">\(X_i\)</span> is <span class="math display">\[\sigma_{ii} = \sum_{k=1}^m l_{ik}^2 + \psi_i\]</span></li>
</ul>
</section></section>
<section>
<section id="communality" class="title-slide slide level1 center">
<h1>Communality</h1>

</section>
<section id="communality-and-specific-variance" class="slide level2">
<h2>Communality and Specific Variance</h2>
<ul>
<li><p>From last slide <span class="math display">\[\sigma_{ii} = \sum_{k=1}^m l_{ik}^2 + \psi_i\]</span></p></li>
<li><p>We say that the variance of <span class="math inline">\(X_i\)</span> is partitioned into communality and specific variance where</p>
<ul>
<li>communality is defined as <span class="math inline">\(h_i^2=\sum_{k=1}^m l_{ik}^2\)</span>, which is the proportion of variance contributed by common factors</li>
<li>specific variance <span class="math inline">\(\psi_i\)</span>, which is the specific variance of <span class="math inline">\(X_i\)</span></li>
</ul></li>
</ul>
</section>
<section id="example-of-communality" class="slide level2">
<h2>Example of Communality</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>obj<span class="ot">=</span><span class="fu">factanal</span>(exam, <span class="at">factors=</span><span class="dv">2</span>)</span>
<span id="cb17-2"><a href=""></a>L<span class="ot">=</span>obj<span class="sc">$</span>loadings[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] </span>
<span id="cb17-3"><a href=""></a>Psi<span class="ot">=</span><span class="fu">diag</span>(obj<span class="sc">$</span>uniquenesses)</span>
<span id="cb17-4"><a href=""></a><span class="co">#uniquenesses</span></span>
<span id="cb17-5"><a href=""></a>obj<span class="sc">$</span>uniquenesses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Latin    English    History Arithmetic    Algebra   Geometry 
0.08437518 0.07777364 0.07581204 0.14534743 0.10513511 0.08395685 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="co">#communality</span></span>
<span id="cb19-2"><a href=""></a><span class="dv">1</span><span class="sc">-</span>obj<span class="sc">$</span>uniquenesses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Latin    English    History Arithmetic    Algebra   Geometry 
 0.9156248  0.9222264  0.9241880  0.8546526  0.8948649  0.9160432 </code></pre>
</div>
</div>
<ul>
<li>For Geometry, the communality is ____ and the uniqueness (specific variance) is ____.</li>
</ul>
</section></section>
<section>
<section id="non-uniqueness" class="title-slide slide level1 center">
<h1>Non-uniqueness</h1>

</section>
<section id="non-uniqueness-of-factor-loadings" class="slide level2">
<h2>Non-uniqueness of Factor Loadings</h2>
<ul>
<li>The factor loading coefficient is NOT unique.</li>
<li>Suppose <span class="math inline">\(\textbf{X} = \boldsymbol{\mu} + \textbf{LF}+ \boldsymbol{\epsilon}\)</span></li>
<li>Consider any <span class="math inline">\(m\times m\)</span> orthogonal matrix <span class="math inline">\(\Gamma\)</span>, which satisfies <span class="math inline">\(\Gamma \Gamma^T=\Gamma^T \Gamma=\mathbf I\)</span>.</li>
<li>Let <span class="math inline">\(\tilde {\mathbf L}=\mathbf L \Gamma\)</span> The model <span class="math inline">\(\textbf{X} = \boldsymbol{\mu} + \tilde {\textbf L} \mathbf F+ \boldsymbol{\epsilon}\)</span></li>
</ul>
<p>give the same <span class="math inline">\(\Sigma\)</span> because <span class="math display">\[cov(\tilde {\textbf L} \mathbf F)= \tilde {\textbf L} cov (\mathbf F)\tilde {\textbf L}^T=\tilde {\textbf L} \tilde {\textbf L}^T=\mathbf L  \Gamma \Gamma^T \mathbf L^T=\mathbf L \mathbf L^T=cov(\mathbf {LF})\]</span></p>
</section>
<section id="non-uniqueness-of-factor-loadings-1" class="slide level2">
<h2>Non-uniqueness of Factor Loadings</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co">#Estimated Sigma</span></span>
<span id="cb21-2"><a href=""></a>L<span class="sc">%*%</span><span class="fu">t</span>(L) <span class="sc">+</span> Psi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Latin   English   History Arithmetic   Algebra  Geometry
Latin      1.0000002 0.9104285 0.9161363  0.4431684 0.3743267 0.3881987
English    0.9104285 1.0000000 0.9222470  0.5448653 0.4843854 0.4989042
History    0.9161363 0.9222470 1.0000001  0.5128914 0.4493253 0.4636887
Arithmetic 0.4431684 0.5448653 0.5128914  1.0000007 0.8702984 0.8814692
Algebra    0.3743267 0.4843854 0.4493253  0.8702984 0.9999997 0.9053334
Geometry   0.3881987 0.4989042 0.4636887  0.8814692 0.9053334 1.0000002</code></pre>
</div>
</div>
</section>
<section id="non-uniqueness-of-factor-loadings-2" class="slide level2">
<h2>Non-uniqueness of Factor Loadings</h2>
<ul>
<li>Consider a rotation matrix <span class="math inline">\(R\)</span> and define <span class="math inline">\(\tilde {\mathbf L}=L R\)</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>theta<span class="ot">=</span>pi<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb23-2"><a href=""></a>R<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta), <span class="sc">-</span><span class="fu">sin</span>(theta), <span class="fu">cos</span>(theta)), <span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb23-3"><a href=""></a>L.tilde<span class="ot">=</span>L<span class="sc">%*%</span>R</span>
<span id="cb23-4"><a href=""></a></span>
<span id="cb23-5"><a href=""></a>L.tilde <span class="sc">%*%</span> <span class="fu">t</span>(L.tilde) <span class="sc">+</span> Psi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Latin   English   History Arithmetic   Algebra  Geometry
Latin      1.0000002 0.9104285 0.9161363  0.4431684 0.3743267 0.3881987
English    0.9104285 1.0000000 0.9222470  0.5448653 0.4843854 0.4989042
History    0.9161363 0.9222470 1.0000001  0.5128914 0.4493253 0.4636887
Arithmetic 0.4431684 0.5448653 0.5128914  1.0000007 0.8702984 0.8814692
Algebra    0.3743267 0.4843854 0.4493253  0.8702984 0.9999997 0.9053334
Geometry   0.3881987 0.4989042 0.4636887  0.8814692 0.9053334 1.0000002</code></pre>
</div>
</div>
</section></section>
<section>
<section id="factor-rotation" class="title-slide slide level1 center">
<h1>Factor Rotation</h1>

</section>
<section id="rotation-for-better-interpretation" class="slide level2">
<h2>Rotation for Better Interpretation</h2>
<ul>
<li>Interpretation of final results are easier for some choices of <span class="math inline">\(\mathbf L\)</span> than others.</li>
<li>We often rotate the factors to gain insights or for better interpretation</li>
<li>This is one advantage of factor analysis</li>
<li>In practice,
<ul>
<li>Step 1: fit a factor model by imposing conditions that lead to a unique solution</li>
<li>Step 2: the loading matrix L is rotated (multiplied by an orthogonal matrix) in a way that gives a good interpretation of the data. Trial and error</li>
</ul></li>
<li>Well know criteria of rotation exist</li>
</ul>
</section>
<section id="two-major-types-of-rotation" class="slide level2">
<h2>Two Major Types of Rotation</h2>
<ul>
<li>An orthogonal rotation
<ul>
<li>maintains the perpendicularity between factors after rotation.</li>
<li>assumes that factors are unrelated or independent of each other.</li>
<li>Varimax is the most commonly used method of orthogonal rotation.</li>
</ul></li>
</ul>
</section>
<section id="two-major-types-of-rotation-1" class="slide level2">
<h2>Two Major Types of Rotation</h2>
<ul>
<li>An oblique rotation
<ul>
<li>allows factors to be correlated and does not maintain a 90 degrees angle.</li>
<li>assumes that factors are related or dependent on each other.</li>
<li>One popular method is Promax</li>
</ul></li>
<li>Orthogonal rotations are mathematically appealing/convenient</li>
<li>There is no reason that factors have to be uncorrelated</li>
</ul>
</section>
<section id="section" class="slide level2">
<h2></h2>

<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="varimax-and-promax" class="slide level2">
<h2>Varimax and Promax</h2>
<div style="font-size: 80%;">
<ul>
<li>https://onlinelibrary.wiley.com/doi/pdf/10.1111/j.1745-3984.2006.00003.x</li>
<li>Consider a rotation matrix with angle <span class="math inline">\(\psi\)</span></li>
</ul>
<p><span class="math display">\[\begin{pmatrix}
cos \psi &amp; -sin \psi\\
sin \psi &amp; cos \psi
\end{pmatrix}\]</span></p>
<ul>
<li>The Varimax method looks for <span class="math inline">\(\psi\)</span> that maximizes the Varimax criterion <span class="math display">\[\frac{1}{p}\sum_{i} \left[\sum_j l_{ij}^4/h_i - (\sum_j (l_{ij}/h_i)^2)^2/p \right] \]</span></li>
<li>The Promax is based on Varimax. It basically shrinks small loadings by using a powerful function</li>
</ul>
</div>
</section>
<section id="no-rotation" class="slide level2">
<h2>No Rotation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">principal</span>(exam,<span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = exam, nfactors = 2, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
            PC1   PC2   h2    u2 com
Latin      0.81 -0.54 0.95 0.052 1.8
English    0.87 -0.43 0.95 0.054 1.5
History    0.85 -0.47 0.95 0.052 1.6
Arithmetic 0.85  0.44 0.91 0.090 1.5
Algebra    0.81  0.52 0.93 0.070 1.7
Geometry   0.82  0.51 0.94 0.064 1.7

                       PC1  PC2
SS loadings           4.19 1.43
Proportion Var        0.70 0.24
Cumulative Var        0.70 0.94
Proportion Explained  0.75 0.25
Cumulative Proportion 0.75 1.00

Mean item complexity =  1.6
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.02 
 with the empirical chi square  0.79  with prob &lt;  0.94 

Fit based upon off diagonal values = 1</code></pre>
</div>
</div>
</section>
<section id="no-rotation-1" class="slide level2">
<h2>No Rotation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)</span>
<span id="cb27-2"><a href=""></a><span class="fu">plot</span>(<span class="fu">principal</span>(exam,<span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"none"</span>), <span class="at">main=</span><span class="st">"No Rotation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="factor-rotation-varimax-an-orthogonal-rotation" class="slide level2">
<h2>Factor Rotation: varimax (an orthogonal rotation)</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">principal</span>(exam,<span class="at">nfactors=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = exam, nfactors = 2)
Standardized loadings (pattern matrix) based upon correlation matrix
            RC1  RC2   h2    u2 com
Latin      0.96 0.17 0.95 0.052 1.1
English    0.93 0.30 0.95 0.054 1.2
History    0.94 0.25 0.95 0.052 1.1
Arithmetic 0.30 0.90 0.91 0.090 1.2
Algebra    0.22 0.94 0.93 0.070 1.1
Geometry   0.24 0.94 0.94 0.064 1.1

                       RC1  RC2
SS loadings           2.86 2.76
Proportion Var        0.48 0.46
Cumulative Var        0.48 0.94
Proportion Explained  0.51 0.49
Cumulative Proportion 0.51 1.00

Mean item complexity =  1.1
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.02 
 with the empirical chi square  0.79  with prob &lt;  0.94 

Fit based upon off diagonal values = 1</code></pre>
</div>
</div>
</section>
<section id="factor-rotation-varimax-an-orthogonal-rotation-1" class="slide level2">
<h2>Factor Rotation: varimax (an orthogonal rotation)</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)</span>
<span id="cb30-2"><a href=""></a><span class="fu">plot</span>(<span class="fu">principal</span>(exam, <span class="at">nfactors=</span><span class="dv">2</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="dv">1</span>), <span class="at">main=</span><span class="st">"varimax (default)"</span>)</span>
<span id="cb30-3"><a href=""></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="factor-rotation-an-oblique-non-orthogonal-rotation" class="slide level2">
<h2>Factor Rotation: an oblique (non-orthogonal) rotation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">principal</span>(exam,<span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"promax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = exam, nfactors = 2, rotate = "promax")
Standardized loadings (pattern matrix) based upon correlation matrix
             RC1   RC2   h2    u2 com
Latin       1.01 -0.08 0.95 0.052   1
English     0.93  0.07 0.95 0.054   1
History     0.96  0.02 0.95 0.052   1
Arithmetic  0.07  0.92 0.91 0.090   1
Algebra    -0.03  0.98 0.93 0.070   1
Geometry   -0.02  0.98 0.94 0.064   1

                       RC1  RC2
SS loadings           2.84 2.78
Proportion Var        0.47 0.46
Cumulative Var        0.47 0.94
Proportion Explained  0.50 0.50
Cumulative Proportion 0.50 1.00

 With component correlations of 
     RC1  RC2
RC1 1.00 0.49
RC2 0.49 1.00

Mean item complexity =  1
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.02 
 with the empirical chi square  0.79  with prob &lt;  0.94 

Fit based upon off diagonal values = 1</code></pre>
</div>
</div>
</section>
<section id="factor-rotation-an-oblique-non-orthogonal-rotation-1" class="slide level2">
<h2>Factor Rotation: an oblique (non-orthogonal) rotation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)</span>
<span id="cb33-2"><a href=""></a><span class="fu">plot</span>(<span class="fu">principal</span>(exam,<span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"promax"</span>), <span class="at">main=</span><span class="st">"promax (oblique)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="factor-rotation-1" class="slide level2">
<h2>Factor Rotation</h2>
<ul>
<li>The following articles provide nice descriptions of the two major types of rotations:</li>
</ul>
<p>https://scholarworks.umass.edu/cgi/viewcontent.cgi?article=1251&amp;context=pare</p>
<p>https://www.theanalysisfactor.com/rotations-factor-analysis/</p>
</section></section>
<section>
<section id="computation" class="title-slide slide level1 center">
<h1>Computation</h1>

</section>
<section id="method-1-use-pca" class="slide level2">
<h2>Method 1: Use PCA</h2>
<ul>
<li><p>By the spectral decomposition of <span class="math inline">\(\Sigma\)</span> we have <span class="math display">\[\Sigma=\Gamma \Lambda \Gamma^T\]</span> where <span class="math inline">\(\Gamma=(\gamma_1, \cdots, \gamma_p)\)</span> is an orthogonal matrix and <span class="math inline">\(\Lambda=diag (\lambda_1, \cdots, \lambda_p)\)</span> be the diagonal matrix of eigenvalues.</p></li>
<li><p>The spectral decomposition can be rewritten to <span class="math display">\[\boldsymbol \Sigma=\sum_{i=1}^p \lambda_i \gamma_i\gamma_i^T=\sum_{i=1}^p (\sqrt{\lambda_i}\gamma_i)(\sqrt{\lambda_i}\gamma_i)^T\]</span></p></li>
</ul>
</section>
<section id="method-1-use-pca-1" class="slide level2">
<h2>Method 1: Use PCA</h2>
<ul>
<li>Suppose that <span class="math inline">\(\lambda_m, \lambda_{m+1}, \cdots,
\lambda_p\)</span> are small. Then</li>
</ul>
<p><span class="math display">\[\boldsymbol \Sigma\approx \sum_{i=1}^m (\sqrt{\lambda_i}\gamma_i)(\sqrt{\lambda_i}\gamma_i)^T\]</span></p>
<ul>
<li><p>Let <span class="math inline">\(\mathbf L=\left(\sqrt{\lambda_1}\gamma_1, \cdots, \sqrt{\lambda_m}\gamma_m\right)\)</span></p></li>
<li><p>Let <span class="math inline">\(\boldsymbol \Psi=\boldsymbol \Sigma-\mathbf L \mathbf L^T\)</span></p></li>
</ul>
</section>
<section id="r-code" class="slide level2">
<h2>R code</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">principal</span>(exam, <span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = exam, nfactors = 2, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
            PC1   PC2   h2    u2 com
Latin      0.81 -0.54 0.95 0.052 1.8
English    0.87 -0.43 0.95 0.054 1.5
History    0.85 -0.47 0.95 0.052 1.6
Arithmetic 0.85  0.44 0.91 0.090 1.5
Algebra    0.81  0.52 0.93 0.070 1.7
Geometry   0.82  0.51 0.94 0.064 1.7

                       PC1  PC2
SS loadings           4.19 1.43
Proportion Var        0.70 0.24
Cumulative Var        0.70 0.94
Proportion Explained  0.75 0.25
Cumulative Proportion 0.75 1.00

Mean item complexity =  1.6
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.02 
 with the empirical chi square  0.79  with prob &lt;  0.94 

Fit based upon off diagonal values = 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">principal</span>(exam, <span class="at">nfactors=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = exam, nfactors = 2)
Standardized loadings (pattern matrix) based upon correlation matrix
            RC1  RC2   h2    u2 com
Latin      0.96 0.17 0.95 0.052 1.1
English    0.93 0.30 0.95 0.054 1.2
History    0.94 0.25 0.95 0.052 1.1
Arithmetic 0.30 0.90 0.91 0.090 1.2
Algebra    0.22 0.94 0.93 0.070 1.1
Geometry   0.24 0.94 0.94 0.064 1.1

                       RC1  RC2
SS loadings           2.86 2.76
Proportion Var        0.48 0.46
Cumulative Var        0.48 0.94
Proportion Explained  0.51 0.49
Cumulative Proportion 0.51 1.00

Mean item complexity =  1.1
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.02 
 with the empirical chi square  0.79  with prob &lt;  0.94 

Fit based upon off diagonal values = 1</code></pre>
</div>
</div>
</section>
<section id="method-2-mle" class="slide level2">
<h2>Method 2: MLE</h2>
<div style="font-size: 80%;">
<ul>
<li>We impose multivariate normality on the common and specific factors</li>
</ul>
<p><span class="math display">\[\mathbf F\sim N(\mathbf 0, \mathbf I), \epsilon\sim N(\mathbf 0, \Psi)\]</span></p>
<ul>
<li>The log-likelihood is <span class="math display">\[\begin{aligned}
l(\mu,\mathbf L, \Psi) &amp;= - \dfrac{np}{2}\log{2\pi}- \dfrac{n}{2}\log{|\mathbf{LL}^T + \Psi|} -\\ &amp;\dfrac{1}{2}\sum_{i=1}^{n}(\mathbf X_i-\mu)^T(\mathbf L \mathbf L^T+\Psi)^{-1}(\mathbf X_i-\mu)
\end{aligned}\]</span></li>
</ul>
<p>where <span class="math inline">\(\mathbf {X}_i\in \mathbb R^p\)</span> denotes the <span class="math inline">\(i\)</span> observation (not the <span class="math inline">\(i\)</span>th feature).</p>
</div>
</section>
<section id="the-number-of-common-factors" class="slide level2">
<h2>The Number of Common Factors</h2>
<ul>
<li>The <span class="math inline">\(p\times p\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span> is symmetric. As a result, there are <span class="math inline">\(\frac{p(p+1)}{2}\)</span> parameters.</li>
<li>A factor mode imposes a structure on <span class="math inline">\(\Sigma\)</span></li>
<li>For a FA model with <span class="math inline">\(m\)</span> common factors</li>
<li>A FA model a small number common factors, i.e., when <span class="math inline">\(m\)</span> is small, the model uses fewer parameters
<ul>
<li>the model is more parsimonious</li>
<li>the model might not be adequate is <span class="math inline">\(m\)</span> is too small</li>
</ul></li>
<li>One can test whether an <span class="math inline">\(m\)</span> is large enough</li>
</ul>
</section>
<section id="choose-m-of-factors-computed-using-pca" class="slide level2">
<h2>Choose <span class="math inline">\(m\)</span> of Factors Computed using PCA</h2>
<ul>
<li><p>Cumulatative variance explained is should be reasonably large, such as &gt;<span class="math inline">\(80\%\)</span></p></li>
<li><p>Look for elbow from the scree plot</p></li>
</ul>
</section>
<section id="a-goodness-of-fit-test-for-the-adequacy-of-the-number-of-common-factors" class="slide level2">
<h2>A Goodness of Fit Test for the Adequacy of the Number of Common Factors</h2>
<div style="font-size: 60%;">
<p><span class="math display">\[\begin{align*}
H_0: \quad
\boldsymbol{\Sigma}_{(p \times p)} &amp;=
\mathbf{L}_{(p \times m)} \, \mathbf{L}'_{(m \times p)} +
\boldsymbol{\Psi}_{(p \times p)} \\
\\
-2 \ln \Lambda &amp;= -2 \ln \left[
\frac{\text{maximized likelihood under } H_0}
     {\text{maximized likelihood}}
\right] \\
\\
&amp;= -2 \ln \left(
\frac{|\hat{\boldsymbol{\Sigma}}|}{|\mathbf{S}_n|}
\right)^{-n/2}
+ n \left[ \operatorname{tr}(\hat{\boldsymbol{\Sigma}}^{-1} \mathbf{S}_n) - p \right] \\
\\
&amp; \text{It can be shown that }
\operatorname{tr}(\hat{\boldsymbol{\Sigma}}^{-1} \mathbf{S}_n) - p = 0 \\
\\
&amp;= n \ln \left(
\frac{|\hat{\boldsymbol{\Sigma}}|}{|\mathbf{S}_n|}
\right)
\end{align*}\]</span></p>
</div>
</section>
<section id="test-for-the-adequacy-of-the-number-of-common-factors" class="slide level2">
<h2>Test for the Adequacy of the Number of Common Factors</h2>
<ul>
<li>The number of parameters for covariance in the full model is <span class="math display">\[\frac{p(p+1)}{2}\]</span></li>
<li>The number of parameters for covariance in the reduced model is <span class="math display">\[mp + p - \frac{m(m-1)}{2}\]</span></li>
</ul>
<p>Note: <span class="math inline">\(- \frac{m(m-1)}{2}\)</span> is due to the nonuniqueness of <span class="math inline">\(\mathbf L\)</span>.</p>
</section>
<section id="degrees-of-freedom" class="slide level2">
<h2>Degrees of freedom</h2>
<ul>
<li>The difference in numbers of parameters between the two models is</li>
</ul>
<p><span class="math display">\[\begin{aligned}
df&amp;=\frac{p(p+1)}{2}-[mp+p-\frac{m(m-1)}{2}]\\
&amp;= \frac{1}{2}[(p-m)^2 -p-m]
\end{aligned}\]</span></p>
<ul>
<li>Under the null hypothesis (adequate), the test statistics follows a chi-squared distribution when the sample size is large enough.</li>
</ul>
</section>
<section id="test-for-the-adequacy-of-the-number-of-common-factors-1" class="slide level2">
<h2>Test for the Adequacy of the Number of Common Factors</h2>
<ul>
<li>The result indicates that 1 factor is not adequate as the p-value is small.</li>
<li>The p-value is about whether the correlation structure specified in the proposed model is significantly different from that of the full model</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">print</span>(<span class="st">"p-value for 1 factor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value for 1 factor"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">factanal</span>(exam, <span class="at">factors=</span><span class="dv">1</span>)<span class="sc">$</span>PVAL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   objective 
2.264759e-30 </code></pre>
</div>
</div>
</section>
<section id="test-for-the-adequacy-of-the-number-of-common-factors-2" class="slide level2">
<h2>Test for the Adequacy of the Number of Common Factors</h2>
<ul>
<li>The result indicates that 2 factors is adequate because the fit is not substantially from the full model.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">print</span>(<span class="st">"p-value for 2 factors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-value for 2 factors"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="fu">factanal</span>(exam, <span class="at">factors=</span><span class="dv">2</span>)<span class="sc">$</span>PVAL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>objective 
 0.930055 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="cfa-vs-efa" class="title-slide slide level1 center">
<h1>CFA vs EFA</h1>

</section>
<section id="exploratory-factor-analysis" class="slide level2">
<h2>Exploratory Factor Analysis</h2>
<ul>
<li>The FA approach we have discussed is exploratory in nature.</li>
<li>In fact, we can perform EFA and identify latent factors by using only correlations, not the data</li>
<li>The purpose of EFA is to explore the possible underlying structure that can explain the observed pattern of correlations</li>
<li>EFA is used when researchers do not have a specific idea about the underlying structure of data</li>
<li>EFA tries to identify the factor configuration (model)</li>
<li>EFA is hypothesis-generating</li>
</ul>
</section>
<section id="exploratory-or-confirmatory-factor-analysis" class="slide level2">
<h2>Exploratory or Confirmatory Factor Analysis</h2>
<ul>
<li>Confirmatory Factory Analysis (CFA) is used when a researcher has specific hypotheses or theories about the factor structure of their data.</li>
<li>It is a theory-driven approach.</li>
<li>In CFA, the researcher specifies the number of factors and which variables load onto which factors.</li>
<li>CFA is typically used in later stages of research to test or confirm the factor structure suggested by EFA<br>
</li>
<li>CFA is hypothesis testing. A pre-specified model is required</li>
</ul>
</section>
<section id="exploratory-or-confirmatory-factor-analysis-1" class="slide level2">
<h2>Exploratory or Confirmatory Factor Analysis</h2>
<ul>
<li>Use EFA when:
<ul>
<li>You are unsure about the underlying structure.</li>
<li>You aim to uncover complex patterns.</li>
<li>You need to form hypotheses and develop theory.</li>
</ul></li>
<li>Use CFA when:
<ul>
<li>You have a predetermined theory or model.</li>
<li>You aim to test the hypothesis about the factor structure.</li>
<li>You need to confirm or disconfirm theories.</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="cfa-example" class="title-slide slide level1 center">
<h1>CFA: Example</h1>

</section>
<section id="r-packages-for-cfa" class="slide level2">
<h2>R Packages for CFA</h2>
<ul>
<li>Conduct CFA in R</li>
<li>R packages:
<ul>
<li>sem</li>
<li>OpenMx</li>
<li>lavaan</li>
</ul></li>
</ul>
</section>
<section id="an-example-using-lavaan" class="slide level2">
<h2>An Example using lavaan</h2>
<ul>
<li>CFA can be performed using the latent variable analysis (lavaan) package in r</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a>model1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb46-2"><a href=""></a><span class="st">verbal =~ Latin + English + History</span></span>
<span id="cb46-3"><a href=""></a><span class="st">math =~ Arithmetic + Algebra + Geometry'</span></span>
<span id="cb46-4"><a href=""></a></span>
<span id="cb46-5"><a href=""></a>obj<span class="ot">=</span><span class="fu">cfa</span>(model1, <span class="at">data=</span><span class="fu">data.frame</span>(exam))</span>
<span id="cb46-6"><a href=""></a><span class="fu">summary</span>(obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 51 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                            60

Model Test User Model:
                                                      
  Test statistic                                 8.586
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.378

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  verbal =~                                           
    Latin             1.000                           
    English           0.993    0.059   16.762    0.000
    History           0.952    0.056   17.055    0.000
  math =~                                             
    Arithmetic        1.000                           
    Algebra           0.976    0.071   13.740    0.000
    Geometry          1.035    0.073   14.253    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  verbal ~~                                           
    math              1.151    0.342    3.360    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Latin             0.285    0.072    3.928    0.000
   .English           0.210    0.063    3.349    0.001
   .History           0.175    0.056    3.140    0.002
   .Arithmetic        0.341    0.084    4.060    0.000
   .Algebra           0.234    0.068    3.423    0.001
   .Geometry          0.206    0.071    2.916    0.004
    verbal            2.505    0.509    4.920    0.000
    math              2.015    0.429    4.693    0.000</code></pre>
</div>
</div>
</section>
<section id="the-user-model" class="slide level2">
<h2>The User model</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="fu">semPaths</span>(obj, <span class="at">what=</span><span class="st">"std"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">edge.label.cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section>
<section id="the-user-model-1" class="slide level2">
<h2>The User model</h2>
<ul>
<li>The model fits well. This suggests that the model does not significantly deviate from the observed data.</li>
</ul>
<pre><code>Model Test User Model:
                                                      
  Test statistic                                 8.586
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.378</code></pre>
</section>
<section id="understand-the-baseline-model" class="slide level2">
<h2>Understand the Baseline model</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>model0 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb50-2"><a href=""></a><span class="st">Latin ~~ Latin</span></span>
<span id="cb50-3"><a href=""></a><span class="st">English ~~ English</span></span>
<span id="cb50-4"><a href=""></a><span class="st">History ~~ History</span></span>
<span id="cb50-5"><a href=""></a><span class="st">Arithmetic ~~ Arithmetic</span></span>
<span id="cb50-6"><a href=""></a><span class="st">Algebra ~~ Algebra</span></span>
<span id="cb50-7"><a href=""></a><span class="st">Geometry ~~ Geometry</span></span>
<span id="cb50-8"><a href=""></a><span class="st">'</span></span>
<span id="cb50-9"><a href=""></a>obj0<span class="ot">=</span><span class="fu">cfa</span>(model0, <span class="at">data=</span><span class="fu">data.frame</span>(exam))</span>
<span id="cb50-10"><a href=""></a><span class="fu">semPaths</span>(obj0, <span class="at">what=</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="understand-the-baseline-model-1" class="slide level2">
<h2>Understand the Baseline model</h2>
<ul>
<li>The null model assumes no relationships between the variables. The output indicates that the baseline model is a poor fit, which is expected since it does not account for any relationships.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="fu">summary</span>(obj0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 8 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         6

  Number of observations                            60

Model Test User Model:
                                                      
  Test statistic                               462.072
  Degrees of freedom                                15
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Latin             2.790    0.509    5.477    0.000
    English           2.679    0.489    5.477    0.000
    History           2.445    0.446    5.477    0.000
    Arithmetic        2.356    0.430    5.477    0.000
    Algebra           2.153    0.393    5.477    0.000
    Geometry          2.366    0.432    5.477    0.000</code></pre>
</div>
</div>
</section>
<section id="model-fit-statistics" class="slide level2">
<h2>Model Fit Statistics</h2>
<ul>
<li><p>We often need to compare a FA (reduced) model to the full model <span class="math display">\[H_0: \boldsymbol \Sigma(\mathbf L, \Psi)=\boldsymbol \Sigma\]</span></p></li>
<li><p>Chi-square test. Derived from the likelihood ratio test. Depends on sample sizes.</p></li>
<li><p>RMSEA: root mean square error of approximation compares the sample correlation matrix and the model correlation matrix. &lt;0.06 is good. <span class="math display">\[RMSEA = \sqrt{\frac{\delta}{df(N-1)}}\]</span> where <span class="math inline">\(\delta=\chi^2 - df\)</span>.</p></li>
</ul>
</section>
<section id="model-fit-statistics-1" class="slide level2">
<h2>Model Fit Statistics</h2>
<ul>
<li>CFI: comparative fit index that measures the relative difference between two models; is not affected by sample size too much; between 0 and 1; the larger the better. &gt;0.9 is good</li>
</ul>
<p><span class="math display">\[CFI= \frac{\delta(\mbox{Baseline}) - \delta(\mbox{User})}{\delta(\mbox{Baseline})}\]</span></p>
<ul>
<li><p>More can be found in wikipedia and</p>
<ul>
<li>https://doi.org/10.1016/B978-0-444-53737-9.50010-4</li>
<li>Bentler PM. Comparative fit indexes in structural models. Psychological bulletin. 1990 Mar;107(2):238.</li>
<li>http://www.davidakenny.net/cm/fit.htm</li>
</ul></li>
</ul>
</section>
<section id="sem-results-cfi-and-tli" class="slide level2">
<h2>SEM Results: CFI and TLI</h2>
<pre><code>CFI: 0.999
TLI: 0.998</code></pre>
<ul>
<li>The Comparative Fit Index (CFI) and Tucker-Lewis Index (TLI) are both close to 1, indicating a good fit of the model to the data. For the two-factor model:
<ul>
<li>acceptable: &gt;0.9</li>
<li>excellent: &gt;0.95</li>
</ul></li>
</ul>
</section>
<section id="cfi-and-tli-for-user-model-and-baseline-model" class="slide level2">
<h2>CFI and TLI for user model and baseline model</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a><span class="fu">fitMeasures</span>(obj0, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  chisq     cfi   rmsea 
462.072   0.000   0.705 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="fu">fitMeasures</span>(obj, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>chisq   cfi rmsea 
8.586 0.999 0.035 </code></pre>
</div>
</div>
</section>
<section id="compute-factor-scores" class="slide level2">
<h2>Compute Factor scores</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a>objscores <span class="ot">&lt;-</span> <span class="fu">lavPredict</span>(obj)</span>
<span id="cb58-2"><a href=""></a><span class="fu">plot</span>(objscores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lecture17FactorAnalysis_files/figure-revealjs/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="helpful-resources" class="slide level2">
<h2>Helpful Resources</h2>
<ul>
<li>https://quantdev.ssri.psu.edu/tutorials/intro-basic-confirmatory-factor-analysis</li>
<li>https://lavaan.ugent.be/tutorial/tutorial.pdf</li>
<li>https://stats.oarc.ucla.edu/r/seminars/rcfa/</li>
</ul>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="co">#knitr::knit_exit()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Lecture17FactorAnalysis_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>